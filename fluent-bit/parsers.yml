# parsers.yml
parsers:
  - name: serilog_compact
    format: json
    time_key: '@t'
    time_format: '%Y-%m-%dT%H:%M:%S.%LZ'

  - name: postgres_log
    format: regex
    regex: '^(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3} [A-Z]+) \[(?<pid>\d+)\] (?<pg_level>[A-Z]+):\s+(?<message>.*)$'
    time_key: time
    time_format: '%Y-%m-%d %H:%M:%S.%L %Z'

  - name: nginx
    format: regex
    regex: '^(?<remote>[^ ]*) (?<host>[^ ]*) (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^"]*?)(?: +\S*)?)?" (?<status>[^ ]*) (?<size>[^ ]*)(?: "(?<referer>[^"]*)" "(?<agent>[^"]*)")?$'
    time_key: time
    time_format: '%d/%b/%Y:%H:%M:%S %z'
    time_keep: On
  
  - name: logfmt
    format: logfmt

  - name: fluentbit_internal
    format: regex
    regex: '^\[(?<time>\d{4}/\d{2}/\d{2} \d{2}:\d{2}:\d{2})\] \[\s*(?<level>\w+)\] \[(?<component>[^\]]+)\] (?<message>.*)$'
    time_key: time
    time_format: '%Y/%m/%d %H:%M:%S'
    time_keep: On

  - name: loki_parser
    format: logfmt
    time_key: ts
    # time_format: '%Y/%m/%d %H:%M:%S'
    # time_keep: On